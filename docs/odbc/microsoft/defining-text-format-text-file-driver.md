---
description: 定义文本格式（文本文件驱动程序）
title: " (文本文件驱动程序) 定义文本格式 |Microsoft Docs"
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- text format [ODBC]
- text file driver [ODBC], text format
ms.assetid: 3af46dad-52cc-4d5c-a27e-6315d65a74e6
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: fe992d4ea7cf81387bc56ef9c384404b015b52a9
ms.sourcegitcommit: e700497f962e4c2274df16d9e651059b42ff1a10
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/17/2020
ms.locfileid: "88340943"
---
# <a name="defining-text-format-text-file-driver"></a>定义文本格式（文本文件驱动程序）
使用文本驱动程序时，可以使用 " **定义文本格式** " 对话框来定义所选文件中的列的格式。 利用此对话框，您可以为每个数据表指定架构。 此信息将写入数据源目录中的 Schema.ini 文件。 为每个文本数据源目录创建一个单独的 Schema.ini 文件。  
  
> [!NOTE]  
>  同一默认文件格式适用于所有新的文本数据表。 CREATE TABLE 语句创建的所有文件都继承这些默认格式值，这些值是通过在 "**定义文本格式**" 对话框中选择 "表" 列表中选择的文件格式值来设置的 \<default> **Tables** 。 文本驱动程序不会更改现有文本文件的格式以与此对话框中定义的格式匹配，但当它使用格式（例如，尝试从文本文件中检索数据时），将返回错误。  
  
 " **定义文本格式** " 对话框中提供了以下选项：  
  
|选项|信息|  
|------------|-----------------|  
|**添加**|使用 " **数据类型**"、" **名称**" 和 " **宽度** " 对话框中的值（如果适用），从 Schema.ini 中的日期分隔符值添加列。|  
|**字符**|**ANSI** 或 **OEM**。 OEM 指定非 ANSI 字符集。 如果此对话框以前没有定义 " **表** " 列表中选定项的格式，则默认为 OEM。|  
|**列名称标头**|指示所选表中第一行的列是否用作列名称。 **TRUE**或**FALSE**。 如果此对话框以前尚未定义 " **表** " 列表中选定项的格式，则默认值为 FALSE。|  
|**“列”**|列出所选表中每一列的列名。 列的顺序反映了表中各列的顺序。 如果在 " **表** " 列表中选择了某个文件，则会启用此列表。|  
|**数据类型**|可以是 BIT、BYTE、CHAR、CURRENCY、DATE、FLOAT、INTEGER、LONGCHAR、SHORT 或 SINGLE。 日期数据类型可以采用以下格式： "yyyy-mm-dd"、"mm-dd-yy"、"mmm-yy"、"yyyy-mm-dd" 或 "yyyy-dd-dd"。 "mm" 表示月数;"mmm" 表示月的字母。|  
|**分隔符**|指定要用于分隔列的自定义分隔符字符。 选择 **自定义分隔** 格式后启用。 分隔符的长度只能为一个字符，且双引号 ( ") 不能用作分隔符字符。  (不能以十六进制或十进制格式指定分隔符。 ) |  
|**格式**|分隔或固定长度。 如果是分隔的，则指示使用的分隔符类型：逗号 (CSV) 、制表符或特殊字符 (自定义) 。 如果此对话框以前没有定义 "**表**" 列表中选定项的格式，则默认为**CSV 分隔**的值。<br /><br /> 如果 **Format** 为固定长度并且 **列名称标头** 为 TRUE，则第一行必须以逗号分隔。|  
|**猜想**|根据选择的 **格式** 框，自动为所选表中的列生成列的数据类型、名称和宽度值。 在分隔表格式时启用。 **列**列表中任何以前定义的列都将被清除并替换为新条目。 如果未选择 **列名称标题** ，则列名称将自动生成为 "F1"、"F2" 等。 " **数据类型** " 框中没有显示默认值。<br /><br /> 此功能仅适用于小于64513个字节的列。|  
|**修改**|使用 " **数据类型**"、" **名称**" 和 " **宽度**" 中的值修改所选列。|  
|**名称**|显示所选列的名称。 可用于为现有列或新列指定新的列名。<br /><br /> 如果 **列名称标头** 为 TRUE，则将忽略显示的列名称。|  
|**删除**|删除所选列。|  
|**要扫描的行**|设置或驱动程序在基于现有数据设置列和列数据类型时将扫描的行数。<br /><br /> 对于要扫描的行数，可以输入1到32767之间的数字。 如果此对话框以前尚未定义 " **表** " 列表中选定项的格式，则默认值为25。  (超出限制的数字将返回错误。 ) |  
|**表**|包含在 " **文本设置** " 对话框中所选目录中与指定扩展名匹配的所有文件的列表。<br /><br /> 如果 \<default> 选择了，并且满足以下条件之一，则 **表** 组中表属性的值将写入到 Schema.ini 中 (Schema.ini 不) 涉及的任何其他条目：<br /><br /> -指定目录中没有 Schema.ini。<br />-Schema.ini 文件存在，但目录中存在指定扩展名)  (的一个文本文件中没有 Schema.ini 部分。<br />-Schema.ini 中存在文本文件的部分，但正文为空。<br /><br /> 如果 \<default> 选择此选项，则禁用 **列** 组。|  
|Width|对于 CHAR 或 LONGCHAR 列，可以更改列的宽度。 如果此对话框以前尚未定义 " **表** " 列表中选定项的格式，则宽度默认为1。<br /><br /> 对于其他数据类型，将禁用 width 控件且不显示任何值。|
