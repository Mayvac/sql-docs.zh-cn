---
description: 何时使用过程
title: 何时使用过程 |Microsoft Docs
ms.custom: ''
ms.date: 01/19/2017
ms.prod: sql
ms.prod_service: connectivity
ms.reviewer: ''
ms.technology: connectivity
ms.topic: conceptual
helpviewer_keywords:
- SQL statements [ODBC], procedures
- procedures [ODBC], about procedures
ms.assetid: 7dc9e327-dd54-4b10-9f66-9ef5c074f122
author: David-Engel
ms.author: v-daenge
ms.openlocfilehash: 7268e8650b0de17edab8776eaaf644ece60100bf
ms.sourcegitcommit: e700497f962e4c2274df16d9e651059b42ff1a10
ms.translationtype: MT
ms.contentlocale: zh-CN
ms.lasthandoff: 08/17/2020
ms.locfileid: "88421371"
---
# <a name="when-to-use-procedures"></a>何时使用过程
使用过程有一些优点，所有这些都基于使用过程将 SQL 语句从应用程序移到数据源这一事实。 应用程序中保留的内容是一个可互操作的过程调用。 这些优势包括：  
  
-   **性能** 过程通常是执行 SQL 语句的最快方法。 与已准备的执行类似，语句以两个单独的步骤进行编译和执行。 与已准备的执行不同，过程只在运行时执行。 它们是在不同的时间进行编译的。  
  
-   **业务规则***业务规则*是公司经营业务的方式的规则。 例如，只有具有标题销售人员的人员才能添加新的销售订单。 通过在过程中放置这些规则，单独的公司可以通过重写应用程序调用的过程来自定义垂直应用程序，而无需修改应用程序代码。 例如，订单输入应用程序可能使用固定数量的参数调用过程 **InsertOrder** ;确切地说， **InsertOrder** 的实现方式不同于公司。  
  
-   **Replaceability** 与在过程中放置业务规则密切相关的是可以在不重新编译应用程序的情况下替换过程。 如果业务规则在公司购买并安装了应用程序后发生更改，则公司可以更改包含该规则的过程。 从应用程序的角度来看，一切都没有改变;它仍调用特定过程来完成特定任务。  
  
-   **DBMS 特定的 SQL** 过程为应用程序提供了一种方法来利用特定于 DBMS 的 SQL 并仍可互操作。 例如，DBMS 上支持 SQL 控制流语句的过程可能会捕获错误并从中恢复，而 DBMS 上不支持控制流语句的过程可能只是返回错误。  
  
-   **过程保留事务** 在某些数据源上，提交或回滚事务时，将删除连接上所有预定义语句的访问计划。 通过将 SQL 语句置于永久存储在数据源中的过程中，语句会在事务中保留下来。 在准备好的、部分准备好或准备就绪状态下的过程是否为 DBMS 特定的。  
  
-   **单独开发** 可以与应用程序的其余部分分开开发过程。 在大型企业中，这可能会提供一种方法来进一步利用高度专门化的程序员的技能。 换句话说，应用程序程序员可以编写用户界面代码，而数据库程序员可以编写过程。  
  
 过程通常由垂直和自定义应用程序使用。 这些应用程序往往会执行固定的任务，并且可以在这些应用程序中执行硬编码过程调用。 例如，订单输入应用程序可能调用过程 **InsertOrder**、 **DeleteOrder**、 **UpdateOrder**和 **GetOrders**。  
  
 从一般应用程序调用过程几乎没有理由。 编写过程通常是为了在特定应用程序的上下文中执行任务，因此不会使用一般的应用程序。 例如，电子表格没有理由调用刚才提到的 **InsertOrder** 过程。 此外，一般应用程序不应在运行时构造过程以提供更快的语句执行;这不仅可能比准备好或直接执行更慢，还需要 DBMS 特定的 SQL 语句。  
  
 这种情况的一个例外是应用程序开发环境，通常为程序员提供一种方法来生成执行过程的 SQL 语句，并为程序员提供测试过程的方法。 此类环境调用 **SQLProcedures** 来列出可用过程，并使用 **SQLProcedureColumns** 来列出输入、输入/输出和输出参数、过程返回值以及过程所创建的任何结果集的列。 但是，必须在每个数据源上预先开发此类过程;这样做需要 DBMS 特定的 SQL 语句。  
  
 使用过程有三个主要缺点。 首先，必须为运行应用程序的每个 DBMS 编写和编译过程。 虽然这不是自定义应用程序的问题，但对于旨在使用大量 Dbms 运行的垂直应用程序，它可能会显著增加开发和维护时间。  
  
 第二个缺点是，很多 Dbms 不支持过程。 同样，这对于旨在使用很多 Dbms 运行的垂直应用程序而言，这可能是一个问题。 若要确定是否支持过程，应用程序需要使用 SQL_PROCEDURES 选项调用 **SQLGetInfo** 。  
  
 第三个缺点（特别适用于应用程序开发环境）是，ODBC 不会定义用于创建过程的标准语法。 也就是说，尽管应用程序可以调用过程 interoperably，但它们无法 interoperably 创建它们。
